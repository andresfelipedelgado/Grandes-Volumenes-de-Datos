{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession.builder.master(\"local\").appName(\"Avila\").config(\"spark.some.config.option\",\"some-value\").getOrCreate()\n","user":"anonymous","dateUpdated":"2020-12-09T20:49:20-0500","config":{"colWidth":12,"fontSize":16,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1606026766402_-598458205","id":"20201122-013246_1027509632","dateCreated":"2020-11-22T01:32:46-0500","dateStarted":"2020-12-09T20:49:19-0500","dateFinished":"2020-12-09T20:49:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2881"},{"text":"%pyspark\n\n\n\ndf_a = spark.read.format(\"org.neo4j.spark.DataSource\").option(\"url\", \"bolt://localhost:7687\").option(\"authentication.type\",\n\"basic\").option(\"authentication.basic.username\",\"neo4j\").option(\"authentication.basic.password\",\"1234\").option(\"labels\",\":Pagina\").load()\ndf_a.show()\n\n\n","user":"anonymous","dateUpdated":"2020-12-10T15:01:28-0500","config":{"colWidth":12,"fontSize":14,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+--------+---------+-------------------+---+-----------+---------+----------+----------+----------+\n|<id>|<labels>|triangles|           pagerank| id|componentId|community|centrality|        F2|        F1|\n+----+--------+---------+-------------------+---+-----------+---------+----------+----------+----------+\n|   0|[Pagina]|        0|0.15000000000000002|  0|          0|    10358|       0.0| 49.002106|-20.973328|\n|   1|[Pagina]|        1|0.15000000000000002|  1|          1|    14041|       0.0| 53.296223|0.37042406|\n|   2|[Pagina]|        2|0.25215256586670876|  2|          2|    10699|       4.0| 14.009132|0.78884166|\n|   3|[Pagina]|        0|0.15000000000000002|  3|          3|    11321|       0.0|  41.09701|-25.238632|\n|   4|[Pagina]|        1|0.15000000000000002|  4|          4|    13324|       0.0| 42.780735|-27.419462|\n|   5|[Pagina]|        2|0.25215256903320554|  5|          5|    12627|       8.0| 20.688812| -51.69298|\n|   6|[Pagina]|        3| 0.2891963632777333|  6|          6|    12959|       5.0| 44.634483|-25.489588|\n|   7|[Pagina]|        1|0.15000000000000002|  7|          7|    11823|       0.0| 38.336777|   69.0647|\n|   8|[Pagina]|        2|0.25215256586670876|  8|          8|     9693|       4.0| 21.409319|-61.258358|\n|   9|[Pagina]|        2| 0.2983446573838592|  9|          9|    13627|       4.5|  71.39308|    31.546|\n|  10|[Pagina]|        0|0.15000000000000002| 10|         10|     6223|       0.0| 54.149258|-4.7959766|\n|  11|[Pagina]|        1|0.15000000000000002| 11|         11|    13328|       0.0|-29.187185|-29.066187|\n|  12|[Pagina]|        0|0.19619208835065366| 12|         12|     5187|      16.0| 52.836933| 32.008327|\n|  13|[Pagina]|        1|0.15000000000000002| 13|         13|      891|       0.0|  8.198531| -8.600249|\n|  14|[Pagina]|        1|0.15000000000000002| 14|         14|    17321|       0.0| 17.339458| 3.1642013|\n|  15|[Pagina]|        1|0.18704380057752135| 15|         15|    21026|       4.0| 5.9610224|-50.520824|\n|  16|[Pagina]|        0|0.15000000000000002| 16|         16|    12439|       0.0|  8.327176| 2.8621707|\n|  17|[Pagina]|        0|0.15000000000000002| 17|         17|     6937|       0.0| -49.03772| -48.74245|\n|  18|[Pagina]|        0|0.15000000000000002| 18|         18|    13071|       0.0| 60.650677|  46.30964|\n|  19|[Pagina]|        1|0.15000000000000002| 19|         19|    12758|       0.0|-39.784615| -64.61606|\n+----+--------+---------+-------------------+---+-----------+---------+----------+----------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1606026895505_1922966881","id":"20201122-013455_539881318","dateCreated":"2020-11-22T01:34:55-0500","dateStarted":"2020-12-10T14:00:22-0500","dateFinished":"2020-12-10T14:00:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2882"},{"text":"%pyspark\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.sql.types import IntegerType\n\n\n\ndf_c = df_a.drop('<id>','<labels>')\n#df_c.show()\n\ndf_aux_ac = spark.read.format(\"csv\").option(\"header\",\"true\").option(\"inferSchema\", \"true\").load(r\"clasificadores.csv\")\n#df_aux_ac.show()\n\ndf_join = df_c.join(df_aux_ac,df_c.id == df_aux_ac.id)\n#df_join.show()\ntest = df_join.drop('id')\n\ntest = test.withColumn(\"F1\", test[\"F1\"].cast(IntegerType()))\ntest = test.withColumn(\"F2\", test[\"F2\"].cast(IntegerType()))\n\n\n#test.show()\ncols=test.columns\ncols.remove(\"AuthorNum\")\n\ntest_tri = test.drop('triangles','pagerank','componentId','community')\n#test_tri = test\ncols=test_tri.columns\ncols.remove(\"AuthorNum\")\n\nassembler = VectorAssembler(inputCols=cols,outputCol=\"features\")\ntest_tri=assembler.transform(test_tri)\ntest_tri.show()\n\n\n\n\n","user":"anonymous","dateUpdated":"2020-12-10T14:55:12-0500","config":{"colWidth":12,"fontSize":14,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---+---+---------+-----------------+\n|centrality| F2| F1|AuthorNum|         features|\n+----------+---+---+---------+-----------------+\n|       0.0| 49|-20|      0.0| [0.0,49.0,-20.0]|\n|       0.0| 53|  0|      0.0|   [0.0,53.0,0.0]|\n|       4.0| 14|  0|      0.0|   [4.0,14.0,0.0]|\n|       0.0| 41|-25|      0.0| [0.0,41.0,-25.0]|\n|       0.0| 42|-27|      0.0| [0.0,42.0,-27.0]|\n|       8.0| 20|-51|      0.0| [8.0,20.0,-51.0]|\n|       5.0| 44|-25|      0.0| [5.0,44.0,-25.0]|\n|       0.0| 38| 69|      0.0|  [0.0,38.0,69.0]|\n|       4.0| 21|-61|      0.0| [4.0,21.0,-61.0]|\n|       4.5| 71| 31|      0.0|  [4.5,71.0,31.0]|\n|       0.0| 54| -4|      0.0|  [0.0,54.0,-4.0]|\n|       0.0|-29|-29|      0.0|[0.0,-29.0,-29.0]|\n|      16.0| 52| 32|      0.0| [16.0,52.0,32.0]|\n|       0.0|  8| -8|      0.0|   [0.0,8.0,-8.0]|\n|       0.0| 17|  3|      0.0|   [0.0,17.0,3.0]|\n|       4.0|  5|-50|      0.0|  [4.0,5.0,-50.0]|\n|       0.0|  8|  2|      0.0|    [0.0,8.0,2.0]|\n|       0.0|-49|-48|      0.0|[0.0,-49.0,-48.0]|\n|       0.0| 60| 46|      0.0|  [0.0,60.0,46.0]|\n|       0.0|-39|-64|      0.0|[0.0,-39.0,-64.0]|\n+----------+---+---+---------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1607462466626_1869936914","id":"20201208-162106_391111070","dateCreated":"2020-12-08T16:21:06-0500","dateStarted":"2020-12-10T14:55:12-0500","dateFinished":"2020-12-10T14:55:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2883"},{"text":"%pyspark\nprint(test_tri.count())\ntrain, test = test_tri.randomSplit([0.8, 0.2],seed=20)","user":"anonymous","dateUpdated":"2020-12-10T14:55:16-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"25478\n"}]},"apps":[],"jobName":"paragraph_1607628322979_1163613534","id":"20201210-142522_1720449806","dateCreated":"2020-12-10T14:25:22-0500","dateStarted":"2020-12-10T14:55:16-0500","dateFinished":"2020-12-10T14:55:17-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2884"},{"text":"%pyspark\n#Momento de entrenar los modelos :3\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nfrom pyspark.ml.classification import RandomForestClassifier\n\n\nrf = RandomForestClassifier(labelCol=\"AuthorNum\", featuresCol=\"features\",numTrees=10,subsamplingRate=1,maxDepth=10)\nrf_model = rf.fit(train)\nrf_prediction = rf_model.transform(test)\n\nevaluator = MulticlassClassificationEvaluator(labelCol=\"AuthorNum\",\n                                              predictionCol=\"prediction\", metricName=\"accuracy\")\n\nrf_accuracy = evaluator.evaluate(rf_prediction)\nprint(\"Accuracy Score of RandomForestClassifier is = {}\".format(rf_accuracy))","user":"anonymous","dateUpdated":"2020-12-10T14:55:21-0500","config":{"colWidth":12,"fontSize":15,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy Score of RandomForestClassifier is = 0.652040030793\n"}]},"apps":[],"jobName":"paragraph_1607627612978_-491545626","id":"20201210-141332_1935735550","dateCreated":"2020-12-10T14:13:32-0500","dateStarted":"2020-12-10T14:55:21-0500","dateFinished":"2020-12-10T14:55:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2885"},{"text":"%pyspark\nrf_model.featureImportances","user":"anonymous","dateUpdated":"2020-12-10T14:49:28-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SparseVector(7, {0: 0.0212, 1: 0.0103, 2: 0.51, 3: 0.3451, 4: 0.007, 5: 0.0525, 6: 0.054})\n"}]},"apps":[],"jobName":"paragraph_1607628339176_-441001945","id":"20201210-142539_1220220401","dateCreated":"2020-12-10T14:25:39-0500","dateStarted":"2020-12-10T14:49:28-0500","dateFinished":"2020-12-10T14:49:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2886"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-12-10T14:48:29-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607629709809_-363539915","id":"20201210-144829_676132901","dateCreated":"2020-12-10T14:48:29-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2887"}],"name":"Get_graph_and_predict","id":"2FR2PUVQX","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}